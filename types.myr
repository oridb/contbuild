use std

pkg contbuild =
	type build = struct
		targs	: target#[:]
		scratch	: byte[:]
		logfd	: std.fd
		period	: std.time
		htmlstyle	: byte[:]
	;;

	type target = struct
		name		: byte[:]

		/* where to find shit */
		repo		: byte[:]
		scratch		: byte[:]
		remote		: byte[:]

		/* commands */
		setup		: byte[:][:]
		build		: byte[:][:]
		test		: byte[:][:]
		clean		: byte[:][:]
		report		: byte[:][:]

		/* html report options */
		htmldir		: byte[:]
		htmlroot	: byte[:]
		htmlstyle	: byte[:]
		commiturl	: byte[:]

		/* email report options */
		email		: byte[:]

		/* computed values */
		_repo		: byte[:]
		_hist		: (byte[:], bool)[:]
		_status		: cmdstatus
		_htmlbase	: byte[:]
		_built		: std.htab(byte[:], byte[:])#
		_commitstatus	: std.htab(byte[:], bool)#
	;;

	type report = struct
		setup	: cmdreport
		build	: cmdreport
		test	: cmdreport
		clean	: cmdreport
	;;

	type cmdreport = struct
		cmd	: byte[:]
		out	: byte[:]
		err	: byte[:]
		ok	: cmdstatus
	;;

	type cmdstatus = union
		`Norun
		`Succ
		`Fail
	;;
;;
